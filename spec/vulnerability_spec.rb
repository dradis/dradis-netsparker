require 'spec_helper'

describe Netsparker::Vulnerability do
  describe 'cleanup_html' do
    it 're-format the html link to textile' do
      sample = "<doc>"\
        "<a href='https://drad.is'>DradisLink1</a>\n"\
        "<a target='_blank' href='https://drad.is'><i class='icon-external-link'></i>DradisLink2</a>"\
        "</doc>"

      doc = described_class.new(nil)
      expected = "<doc>\"DradisLink1\":https://drad.is\n\"DradisLink2\":https://drad.is</doc>"
      expect(doc.send(:cleanup_html, sample)).to eq(expected)
    end
  end
end
